<?php
 namespace Mgt\Varnish\Controller\Adminhtml\Queue; class Information extends \Magento\Backend\App\Action { const SQL_LIMIT_URL_QUEUE = 500; protected $jsonHelper; protected $storeManager; protected $urlQueueCollection; public function __construct(\Magento\Backend\App\Action\Context $context, \Magento\Framework\Json\Helper\Data $jsonHelper, \Magento\Store\Model\StoreManagerInterface $storeManager, \Mgt\Varnish\Model\ResourceModel\UrlQueue\Collection $urlQueueCollection) { goto eba65; eba65: parent::__construct($context); goto f4209; C8d28: $this->urlQueueCollection = $urlQueueCollection; goto bffcc; bffcc: $this->storeManager = $storeManager; goto D128b; f4209: $this->jsonHelper = $jsonHelper; goto C8d28; D128b: } public function execute() { goto Cfc13; Cfc13: $numberOfUrls = $this->urlQueueCollection->getSize(); goto f7555; a4b50: return $response; goto d2bba; Fa2b3: $response->representJson($this->jsonHelper->jsonEncode($data)); goto a4b50; f980c: $data = ["\156\x75\155\x62\x65\162\x4f\x66\x55\x72\154\163" => $numberOfUrls, "\143\157\156\164\145\x6e\164" => implode("\x3c\142\162\76", $urlsInQueue)]; goto C28d7; f7555: $urlsInQueue = $this->getUrlsFromQueue(); goto f980c; C28d7: $response = $this->getResponse(); goto Fa2b3; d2bba: } public function getUrlsFromQueue() { goto De78d; Fa8d8: foreach ($this->urlQueueCollection as $url) { goto Aa9da; D35b2: $urls[] = $url; goto cb98f; Fbcdf: $url = sprintf("\45\x73\57\45\163", rtrim($store->getBaseUrl(), "\57"), ltrim($url->getPath(), "\57")); goto D35b2; cb98f: cbe62: goto B622c; ed893: $store = $this->storeManager->getStore($storeId); goto Fbcdf; Aa9da: $storeId = $url->getStoreId(); goto ed893; B622c: } goto D16c3; F921f: return $urls; goto c4d65; De78d: $urls = []; goto d960a; D16c3: E9d6d: goto F921f; dfd38: $this->urlQueueCollection->load(); goto Fa8d8; E7299: $this->urlQueueCollection->setPageSize(self::SQL_LIMIT_URL_QUEUE); goto dfd38; d960a: $this->urlQueueCollection->addOrder("\x70\x72\151\x6f\x72\x69\x74\171"); goto E7299; c4d65: } }
